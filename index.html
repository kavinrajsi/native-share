<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Awesome Image Website Share</title>
    <script
      src="https://code.jquery.com/jquery-3.7.1.slim.js"
      integrity="sha256-UgvvN8vBkgO0luPSUl2s8TIlOSYRoGFAX4jlCIm9Adc="
      crossorigin="anonymous"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="./blob.js"></script>
    <script src="./canvas-toBlob.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
    <style>
      .cert-wrapper {
        position: relative;
      }
      .name-block {
        justify-content: center;
        align-items: flex-end;
        margin-right: 1rem;
        display: flex;
        position: absolute;
        top: 37%;
        bottom: auto;
        left: 0%;
        right: 0%;
      }
    </style>
  </head>
  <body>
    <div id="content" class="cert-wrapper">
      <img
        src="./hero.jpeg"
        width="Auto"
        id="certificateImage"
        alt=""
        class="image-full"
      />
      <div class="name-block">
        <h1 id="result" class="heading-style-h3 is-new">kavinraj si</h1>
      </div>
    </div>

    <img
      id="share-image"
      src="https://native-share.vercel.app/test.png"
      alt="Share Image"
      style="display: none"
    />
    <div>
      <button id="download">Download Image</button>
      <button id="download-image">Download</button>
      <button id="share-facebook">Share on Facebook</button>
      <button id="share-linkedin">Share on LinkedIn</button>
      <button id="share-twitter">Share on Twitter</button>
      <button id="share-pinterest">Share on Pinterest</button>
      <button id="native-share-button">Share</button>
    </div>

    <script>
      document.getElementById("download").onclick = function () {
        html2canvas(document.querySelector("#content")).then((canvas) => {
          // document.body.appendChild(canvas)
        });
      };

      // document
      //   .getElementById("download-image")
      //   .addEventListener("click", function (event) {
      //     event.preventDefault(); // Prevent default anchor behavior
      //     var img = document.getElementById("share-image");
      //     var link = document.createElement("a");
      //     link.href = img.src;
      //     link.download = "image.png";
      //     document.body.appendChild(link);
      //     link.click();
      //     document.body.removeChild(link);
      //   });

      // NOTE: Need to look at how we can add an description
      document.getElementById("share-facebook").onclick = function () {
        var imageUrl = document.getElementById("share-image").src;
        var text = "Check out this awesome image!";
        var facebookShareUrl =
          "https://www.facebook.com/sharer/sharer.php?u=" +
          encodeURIComponent(imageUrl) +
          "";
        window.open(facebookShareUrl, "_blank", "width=600,height=400");
      };

      document.getElementById("share-linkedin").onclick = function () {
        var imageUrl = document.getElementById("share-image").src;
        var text = "Check out this awesome image!";
        var linkedinShareUrl =
          "https://www.linkedin.com/shareArticle?mini=true&url=" +
          encodeURIComponent(imageUrl) +
          "&title=" +
          encodeURIComponent(text);
        window.open(linkedinShareUrl, "_blank", "width=600,height=400");
      };
      // NOTE: Need to look at how we can add an image
      document.getElementById("share-twitter").onclick = function () {
        var imageUrl = document.getElementById("share-image").src;
        var text = "Check out this awesome image!";
        var twitterShareUrl =
          "https://twitter.com/intent/tweet?url=" +
          encodeURIComponent(imageUrl) +
          "&text=" +
          encodeURIComponent(text);
        window.open(twitterShareUrl, "_blank", "width=600,height=400");
      };

      document.getElementById("share-pinterest").onclick = function () {
        var imageUrl = document.getElementById("share-image").src;
        var text = "Check out this awesome image!";
        var pinterestShareUrl =
          "https://pinterest.com/pin/create/button/?url=" +
          encodeURIComponent(imageUrl) +
          "&description=" +
          encodeURIComponent(text) +
          "&media=" +
          encodeURIComponent(imageUrl);
        window.open(pinterestShareUrl, "_blank", "width=600,height=400");
      };
      // NOTE: Need to configure the code for native share
      document.getElementById("native-share-button").onclick = function () {
        var imageUrl = document.getElementById("share-image").src;
        var text = "Check out this awesome image!";
        var url = imageUrl; // Assuming you want to share the image URL

        if (navigator.share) {
          navigator
            .share({
              title: "Awesome Image",
              text: text,
              url: url,
            })
            .then(() => {
              console.log("Successful share");
            })
            .catch((error) => {
              console.error("Error sharing:", error);
            });
        } else {
          alert("Your browser does not support the native share feature.");
        }
      };
    </script>

    <script>
      // Initialize Firebase with your config
      const firebaseConfig = {
        apiKey: "AIzaSyD-vsblELU17PZm2er8B8Lkbo2QQg_07WM",
        authDomain: "certificate-91b26.firebaseapp.com",
        projectId: "certificate-91b26",
        storageBucket: "certificate-91b26.appspot.com",
        messagingSenderId: "918378444843",
        appId: "1:918378444843:web:e28d2b80e038ddf13f926e",
        measurementId: "G-Z2H7XV1FN7",
      };
      firebase.initializeApp(firebaseConfig);
      const storageRef = firebase.storage().ref();

      window.imageFilename = "certificate_of_kavinraj_1716573494522.png";
      storageRef
        .child(window.imageFilename)
        .getDownloadURL()
        .then((url) => {
          document
            .getElementById("download-image")
            .addEventListener("click", function (event) {
              event.preventDefault(); // Prevent default anchor behavior
              console.log(url);
              document.getElementById("share-image").src = url; // Set the src attribute of the image
              var img = document.getElementById("share-image");
          var link = document.createElement("a");
          link.href = img.src;
          link.download = "image.png";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
            });
        })
        .catch((error) => {
          console.error("Error getting download URL: ", error);
        });
    </script>
  </body>
</html>
